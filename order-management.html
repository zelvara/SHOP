<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Zelvara - Order Management</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #fefdfe;
      padding: 2rem;
    }
    .container {
      max-width: 1000px;
      margin: auto;
    }
    .order-header {
      text-align: center;
      margin-bottom: 2rem;
    }
    .table th, .table td {
      vertical-align: middle;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2 class="order-header">Order Management</h2>
    <div id="ordersContainer"></div>
  </div>

  <script>
    function loadOrders() {
      let orders = JSON.parse(localStorage.getItem("orders")) || [];
      const container = document.getElementById("ordersContainer");
      
      if (orders.length === 0) {
        container.innerHTML = "<p>No orders have been placed yet.</p>";
        return;
      }
      
      let html = `<table class="table table-bordered">
                    <thead>
                      <tr>
                        <th>#</th>
                        <th>Timestamp</th>
                        <th>Products</th>
                        <th>Delivery Address</th>
                        <th>Total Amount</th>
                        <th>UTR</th>
                        <th>Status</th>
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody>`;
      
      orders.forEach((order, index) => {
        let productsHtml = "<ul>";
        (order.products || []).forEach(prod => {
          productsHtml += `<li>${prod.name} - ₹${prod.price} (Size: ${prod.size})</li>`;
        });
        productsHtml += "</ul>";
        
        html += `<tr>
                    <td>${index + 1}</td>
                    <td>${order.timestamp || ''}</td>
                    <td>${productsHtml}</td>
                    <td>${order.address || ''}, ${order.city || ''}, ${order.state || ''} - ${order.pincode || ''}</td>
                    <td>₹${order.total || ''}</td>
                    <td>${order.utr || ''}</td>
                    <td>
                      <select onchange="updateStatus(${index}, this.value)" class="form-select">
                        <option value="Processing" ${order.status === "Processing" ? "selected" : ""}>Processing</option>
                        <option value="Shipped" ${order.status === "Shipped" ? "selected" : ""}>Shipped</option>
                        <option value="Delivered" ${order.status === "Delivered" ? "selected" : ""}>Delivered</option>
                        <option value="Cancelled" ${order.status === "Cancelled" ? "selected" : ""}>Cancelled</option>
                      </select>
                    </td>
                    <td><button class="btn btn-danger" onclick="deleteOrder(${index})">Delete</button></td>
                  </tr>`;
      });
      
      html += `</tbody></table>`;
      container.innerHTML = html;
    }

    function updateStatus(index, newStatus) {
      let orders = JSON.parse(localStorage.getItem("orders")) || [];
      orders[index].status = newStatus;
      localStorage.setItem("orders", JSON.stringify(orders));
      alert("Order status updated.");
      loadOrders();
    }

    function deleteOrder(index) {
      if (confirm("Are you sure you want to delete this order?")) {
        let orders = JSON.parse(localStorage.getItem("orders")) || [];
        orders.splice(index, 1);
        localStorage.setItem("orders", JSON.stringify(orders));
        loadOrders();
      }
    }

    window.onload = loadOrders;
  </script>
</body>
</html>
